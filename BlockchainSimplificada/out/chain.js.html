<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: chain.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: chain.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Creditos a  @author Jorge luís
 * Modificada por @author William Luis Alves Ferreira
 * Modificado por @author Bruner Eduardo
 */
const block = require('./block');
/**
 * @description Função instanciadora do lista de blocos da chain, inicialidando com bloco inicial nulo
 */
const Chain = (function() {
  let instance;

  const firstBlock = {
    index : 0,
    prevHash : 0,
    timestamp : 0,
    data : 'Blockchain is Borning',
    hash : block.generateHash({index : 0, prevHash : 0, timestamp : 0,  data : 'Blockchain is Borning'}),
  };

  const chain = [firstBlock];
/**
 * @description Valida o update da chain usando como parametro o tempo de inserção e coerência com o restante da rede
 * @param {Object} chain bloco inicial 
 */
  function validateChain(chain) {
    let validChain = true;
    if(JSON.stringify(chain[0]) !== JSON.stringify(origin)) {
      validChain = false;
      return validChain;
    }
    
    const temp = [chain[0]];

    for(let i=1; i &lt; chain.length; i++) {
      if (block.validateBlock(chain[i], temp[i-1])) {
        temp.push(chain[i]);
      } else {
        validChain = false;
        return validChain;
      }
    }

    return validChain;

  }

  function get() {
    return chain;
  };

  function last() {
    return chain.slice().pop();
  }

  function update(newBlock) {
    block.validateBlock(newBlock) ? chain.push(newBlock) : console.log('invalid block recived');
  }

  function replace(newChain) {
    if (validateChain(newChain) &amp;&amp; newChain.length > chain.length) {
      chain.splice(0, chain.length);
      chain.push(...newChain);
    } else {
      console.log('invalid chain recived');
    }
  }

  function create() {
    return {get, last, update, replace}
  }

  return {
    init() {
      if (!instance) {
        instance = create();
      }

      return instance;

    }
  };

})();

module.exports = Chain.init();</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#block">block</a></li><li><a href="global.html#Chain">Chain</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Sun Sep 29 2019 19:33:59 GMT-0300 (GMT-03:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
